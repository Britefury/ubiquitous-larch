ccopy_reg
_reconstructor
p0
(clarch.worksheet.worksheet
Worksheet
p1
c__builtin__
object
p2
Ntp3
Rp4
(dp5
S'blocks'
p6
(lp7
g0
(clarch.worksheet.worksheet
WorksheetBlockText
p8
g2
Ntp9
Rp10
(dp11
S'worksheet'
p12
g4
sS'text'
p13
V<p>Message Channel Resource Test</p>
p14
sbag0
(clarch.worksheet.worksheet
WorksheetBlockCode
p15
g2
Ntp16
Rp17
(dp18
g12
g4
sS'code'
p19
g0
(clarch.source_code
PythonCode
p20
g2
Ntp21
Rp22
(dp23
g19
Vfrom larch.pres.resource import *\u000afrom larch.pres.html import Html\u000afrom larch.live import LiveValue, LiveFunction\u000afrom larch.controls import button\u000a\u000a\u000a
p24
sS'editable'
p25
I01
sbsbag0
(clarch.worksheet.worksheet
WorksheetBlockSource
p26
g2
Ntp27
Rp28
(dp29
g12
g4
sg19
g0
(clarch.source_code
JSCode
p30
g2
Ntp31
Rp32
(dp33
g19
Vfunction initMessageTestNode(node, channel) {\u000a    channel.addListener(function(message){\u000a        // message contains the message sent from the server\u000a        \u000a        // Prepend some text and send back:\u000a        channel.sendMessage('Back from client: ' + message);\u000a    });\u000a}
p34
sg25
I01
sbsS'var_name'
p35
Vch_js
p36
sbag0
(g15
g2
Ntp37
Rp38
(dp39
g12
g4
sg19
g0
(g20
g2
Ntp40
Rp41
(dp42
g19
Vchannel = MessageChannel()\u000achannel_test = Html('<span>Channel test</span>').js_function_call('initMessageTestNode', channel).use_js(source=ch_js)\u000a\u000a\u000achannel_test
p43
sg25
I01
sbsbag0
(g15
g2
Ntp44
Rp45
(dp46
g12
g4
sg19
g0
(g20
g2
Ntp47
Rp48
(dp49
g19
V# Our result\u000aresult = LiveValue('')\u000a\u000a# A message listener\u000adef on_message(msg):\u000a    # Received message through channel from client: set the value of the LiveValue\u000a    result.value = msg\u000a   \u000a# Register listener\u000achannel.add_listener(on_message)\u000a\u000aresult
p50
sg25
I01
sbsbag0
(g15
g2
Ntp51
Rp52
(dp53
g12
g4
sg19
g0
(g20
g2
Ntp54
Rp55
(dp56
g19
Vdef on_click():\u000a    # Send a message over the channel from the server to the client. It will appear within the JS code above\u000a    channel.send('Hello world')\u000a\u000a\u000abutton.button('Click me', on_click)
p57
sg25
I01
sbsbasb.